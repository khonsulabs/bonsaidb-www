<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="darkreader" content="NO-DARKREADER-PLUGIN" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>A Year of BonsaiDb: A retrospective and looking to the future</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/monokai.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script src="/nodarkreader.min.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/bonsaidb-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/bonsaidb-16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="alternate" type="application/atom+xml" title="The BonsaiDb Blog" href="/blog/atom.xml" />
</head>

<body>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="/">
                <img src="/bonsaidb-64.png" height="28" />
                <h1>BonsaiDb</h1>
            </a>
            <div class="is-hidden-mobile is-flex-tablet">
                <a class="navbar-item 



" href="/">
                    Getting Started
                </a>
                <a class="navbar-item 



" href="/about/">
                    What is BonsaiDb?
                </a>
                <a class="navbar-item 


is-active
" href="/blog/">
                    Blog
                </a>
            </div>
            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>

        <div class="navbar-menu" id="navbar-menu">
            <div class="navbar-start is-hidden-tablet is-flex-mobile">
                <div class="">
                    <a class="navbar-item 



" href="/">
                        Getting Started
                    </a>
                    <a class="navbar-item 



" href="/about/">
                        What is BonsaiDb?
                    </a>
                    <a class="navbar-item 


is-active
" href="/blog/">
                        Blog
                    </a>
                </div>
            </div>
            <div class="navbar-end">
                <a class="navbar-item" href="https://dev.bonsaidb.io/release/guide/">
                    <i class="font-icon bi-book"></i> User's Guide</a>
                <a class="navbar-item" href="https://dev.bonsaidb.io/release/docs/bonsaidb">
                    <i class="font-icon bi-journal-code"></i>
                    Documentation</a>
                <a class="navbar-item" href="https://community.khonsulabs.com/c/open-source/bonsaidb/18">
                    <i class="font-icon bi-chat"></i>
                    Forums</a>
                <a class="navbar-item" href="https://discord.khonsulabs.com">
                    <i class="font-icon bi-discord"></i>
                    Discord</a>
                <a class="navbar-item" href="https://github.com/khonsulabs/bonsaidb">
                    <i class="font-icon bi-github"></i> Source
                    Code</a>
            </div>
        </div>
    </nav>

    
<div class="container content px-4">
    <h1>A Year of BonsaiDb: A retrospective and looking to the future</h1>
    
    <p>
        
        Written by <a href="https:&#x2F;&#x2F;github.com&#x2F;ecton">Jonathan Johnson</a>.
        
        
        Published 2022-03-19.
        
        
    </p>
    
    <blockquote>
<p><strong>What is BonsaiDb?</strong></p>
<p><a href="https://github.com/khonsulabs/bonsaidb">BonsaiDb</a> is a new database aiming to be the most developer-friendly
Rust database. BonsaiDb has a unique feature set geared at solving many common
data problems. We have a page dedicated to answering the question: <a href="https://bonsaidb.io/about">What is
BonsaiDb?</a>.</p>
</blockquote>
<p>Today marks the one year anniversary of the <a href="https://github.com/khonsulabs/bonsaidb/commit/43bd3a25b61fc7841c9554422d7bb46ad4362e59">initial commit</a> to
<a href="https://github.com/khonsulabs/bonsaidb">BonsaiDb</a>. This project is largely a written by <a href="https://github.com/ecton">me (@Ecton)</a>,
although I'm very thankful to have been accompanied along the way by
<a href="https://github.com/daxpedda">@daxpedda</a>. He is responsible for the <a href="https://github.com/khonsulabs/fabruic">QUIC networking
layer</a>, our currently removed OPAQUE-KE support, and above all,
countless long discussions and debates that not only led to starting this
project, but also to the easy-to-use API designs we have today.</p>
<p>In the last few months, we've also had two additional contributors:
<a href="https://github.com/modprog">@ModProg</a> and <a href="https://github.com/vbmade2000">@vbmade2000</a>. I'm grateful for their
additions to the project, and I hope this year we see even more contributors as
BonsaiDb gains momentum.</p>
<h2 id="">


<a href="#Beginning%20a%20real%20bonsai%20cluster" name="Beginning%20a%20real%20bonsai%20cluster">
    Beginning a real bonsai cluster
    <i class="bi bi-link-45deg hoverable"></i>
</a></h2>
<p>The name BonsaiDb was suggested by <a href="https://github.com/daxpedda">@daxpedda</a> after countless times
where we stumbled trying to pronounce the project's former name: PliantDb. When
I <a href="https://community.khonsulabs.com/t/short-update-pliantdb-is-now-known-as-bonsaidb/74">announced the new name</a>, I researched trying to grow a bonsai
tree in the Las Vegas climate. My initial findings were that many of the iconic
types are difficult to grow here, and I ended up shelving the idea.</p>
<p>As March was approaching, I knew I wanted to commemorate the anniversary of the
first commit. I researched again and found two species that were great
candidates for being able to be grown mostly indoors. After some deliberation, I
decided to start with a Golden Gate (Tiger Bark) Ficus:</p>
<img src="&#x2F;images&#x2F;one-year-anniversary-ficus.jpg" class="block-image" alt="One Year Anniversary Golden Gate Ficus"  width="400"  />
<p>After giving the tree another week or two of adjustment to its new home, I'll be
pruning it for the first time and attempting to grow a second tree from its
cuttings. Within the limits of being able to provide good living conditions for
each tree, I hope to expand the &quot;cluster&quot; each year and will share progress
pictures along the way!</p>
<h3 id="-1">


<a href="#The%20first%20year%3A%20Inspiration" name="The%20first%20year%3A%20Inspiration">
    The first year: Inspiration
    <i class="bi bi-link-45deg hoverable"></i>
</a></h3>
<p>The inspiration for <a href="https://github.com/khonsulabs/bonsaidb">BonsaiDb</a> came from weeks and weeks of
discussions between <a href="https://github.com/ecton">myself</a> and <a href="https://github.com/daxpedda">@daxpedda</a>. We were wanting
to build an cluster architecture for an MMO that:</p>
<ul>
<li>Was easy to deploy and maintain</li>
<li>Was affodable</li>
<li>Could scale horizontally</li>
<li>Could subdivide players by &quot;location&quot; within the cluster:
<ul>
<li>Each location could have database/cache/cpu resources allocated dynamically</li>
<li>Each location would be Highly Available</li>
</ul>
</li>
<li>Used as many Rust-written solutions as possible</li>
</ul>
<p>At the start of our discussions, I was dead-set on using PostgreSQL and Redis
for our database/caching needs. However both PostgreSQL and Redis aren't easy to
deploy and maintain in a highly available cluster, and if I chose managed
solutions, they definitely weren't affordable.</p>
<p>When starting my last company, I chose <a href="https://couchdb.apache.org/">CouchDB</a> for various reasons
that aren't worth diving into. Through the ten years of growing that company, I
became intimately familiar with the simple yet powerful design of CouchDB.
Several times I pondered rewriting CouchDB atop PostgreSQL using JSONB columns
to see how it would perform. I never ended up taking any of those prototypes
very far, but the thought process helped me appreciate and understand CouchDB's
inner workings better.</p>
<p>One day while working on <a href="https://github.com/khonsulabs/cosmicverge">Cosmic Verge</a>, it dawned on me: I had
built a small wrapper around <a href="https://sled.rs">Sled</a> that made it feel like a higher-level
database. What if I went further and built a CouchDB-like API atop Sled?</p>
<h3 id="-2">


<a href="#The%20first%20year%3A%20Initial%20Goals" name="The%20first%20year%3A%20Initial%20Goals">
    The first year: Initial Goals
    <i class="bi bi-link-45deg hoverable"></i>
</a></h3>
<p>Initially, I was hesitant to tell anyone I was building a database. Despite
relying on <a href="https://sled.rs">Sled</a> for the low-level transactional storage, it still felt
like one of those projects that is usually ill-advised. I finally felt confident
enough in my reasoning of <em>why</em> I was building <a href="https://github.com/khonsulabs/bonsaidb">BonsaiDb</a> that I <a href="https://community.khonsulabs.com/t/did-i-say-i-was-refocusing/58#pliantdb-the-core-of-cosmic-verge-2">wrote a detailed
devlog</a> describing the motivation for tackling this new
project.</p>
<p>Early on, I never had high ambitions for BonsaiDb. After all, this was the first
database I had ever written. The likelihood of me building a high-performance
database seemed low. Instead, I wanted to focus primarily on developer
experience, reliability, and ease of deployment. I tried to make intelligent
choices based on my expectations of what would be efficient, but I intentionally
avoided comparing BonsaiDb against other databases until <a href="https://bonsaidb.io/blog/commerce-benchmark/">January of this
year</a>.</p>
<p>To me the selling points of BonsaiDb were (and still are):</p>
<ul>
<li>Straightforward to use and deploy.</li>
<li>Can write generic code that works regardless of how BonsaiDb is deployed.</li>
<li>&quot;Battery-powered&quot; with common needs for developers, reducing complexity of deployments:
<ul>
<li>ACID-compliant transactional document storage</li>
<li>Lightweight Atomic Key-Value store (a-la Redis)</li>
<li>PubSub</li>
<li>Unified and extensible authentication and permissions model</li>
<li>Persistent Job Queue System (a la SQS/Resque/Sidekiq). Work on this has been
started but is not shipping yet, but it has been a goal from the start of
the project.</li>
</ul>
</li>
<li>Built in Rust, for Rust.</li>
<li>Vision includes a &quot;grows with you&quot; pitch:
<ul>
<li>Bi-directional replication</li>
<li>Quorum-based clustering</li>
<li>Modular plugin system to support &quot;resuable&quot; collections and services</li>
</ul>
</li>
</ul>
<h3 id="-3">


<a href="#BonsaiDb%20isn%27t%20just%20a%20toy" name="BonsaiDb%20isn%27t%20just%20a%20toy">
    BonsaiDb isn&#x27;t just a toy
    <i class="bi bi-link-45deg hoverable"></i>
</a></h3>
<p>In October a series of events made me look at porting the append-only B-Tree
implementation from CouchDB to Rust as a potential replacement for <a href="https://sled.rs">Sled</a>
in our architecture. In the end, the bug that I was experiencing on Mac <a href="https://community.khonsulabs.com/t/introducing-nebari-a-key-value-data-store-written-using-an-append-only-file-format/81#what-caused-the-uncontrolled-memory-usage-5">was
unrelated</a> to Sled, but its symptoms manifested in such a way that
resembled issues others have had with Sled in the past.</p>
<p>After getting some basic unit tests working, I did something really stupid: I
benchmarked it against Sled and SQLite. Why was it stupid? It kicked off a
viscious few weeks, nearly reaffirming the common wisdom: why was I trying to
write my own database? I would stare <a href="https://khonsulabs-storage.s3.us-west-000.backblazeb2.com/nebari-scaleway-gp1-xs/index.html">at microbenchmarks</a> and
profiling results, tweak something, and try again. Over and over. For some
reason it just wasn't occurring to me: the fact <a href="https://github.com/khonsulabs/nebari">Nebari</a> was even in the
same realm as these highly optimized databases was exciting enough. Eventually,
I <a href="https://community.khonsulabs.com/t/introducing-nebari-a-key-value-data-store-written-using-an-append-only-file-format/81#why-still-develop-nebari-6">convinced myself</a> it was better for the future of BonsaiDb to
adopt Nebari.</p>
<p>In January I was preparing to release our first alpha. I knew if I didn't have
benchmarks available, it would be one of the first questions asked. I wrote a
benchmark suite aimed at comparing BonsaiDb against PostgreSQL in a simple
eCommerce setup. I wasn't prepared for the results: BonsaiDb is significantly
faster than PostgreSQL <a href="https://khonsulabs-storage.s3.us-west-000.backblazeb2.com/bonsaidb-scaleway-gp1-xs/commerce/index.html">in this benchmark suite</a>.</p>
<p>Last month I set my focus <a href="https://bonsaidb.io/blog/february-2022-update/#Testing%20BonsaiDb%20with%20a%20large%20dataset">testing large datasets</a> and was able
to achieve performance again that exceeded my expectations. I no longer am
viewing BonsaiDb as an easy-to-use database that will be &quot;good enough&quot; for many
people. I now view BonsaiDb as having the potential to be a serious database
option for most people.</p>
<p>For being just one year old, I'm extremely happy with where BonsaiDb is today.</p>
<h2 id="-4">


<a href="#Year%20Two%3A%20My%20Goals" name="Year%20Two%3A%20My%20Goals">
    Year Two: My Goals
    <i class="bi bi-link-45deg hoverable"></i>
</a></h2>
<p>One thing that surprised me was how much interest <a href="https://github.com/khonsulabs/nebari">Nebari</a> garnered.
Despite not heavily advertising it, it's accumulated a fair number of stars on
GitHub. It's popular enough that I've been rethinking how I was planning on
implementing certain features. Outside of bug fixes and minor features, I
haven't spent much time working on Nebari as it has been meeting BonsaiDb's
needs. I would like to spend more time in this coming year making Nebari a
better crate for developers to consume directly. Ultimately, the more users
Nebari has, the more confidence everyone can have in BonsaiDb's ACID compliance.</p>
<p>For <a href="https://github.com/khonsulabs/bonsaidb">BonsaiDb</a>, there are several goals I have:</p>
<ul>
<li>
<p><strong>Features, Features, Features</strong>: I'm excited at exploring a wide variety of
features aiming to make BonsaiDb more powerful and easier to use:</p>
<ul>
<li><a href="https://github.com/khonsulabs/bonsaidb/pull/220">Ability to use BonsaiDb in non-async
code</a></li>
<li><a href="https://github.com/khonsulabs/bonsaidb/issues/78">Persistent Job Queue</a></li>
<li><a href="https://github.com/khonsulabs/bonsaidb/issues/162">Supporting Metrics</a></li>
<li><a href="https://github.com/khonsulabs/bonsaidb/issues/136">Document Dependencies/Foreign Keys/Graph Relationships</a></li>
<li><a href="https://github.com/khonsulabs/bonsaidb/issues/69">Collection Lifecycles</a></li>
<li><a href="https://github.com/khonsulabs/bonsaidb/issues/90">Replication</a></li>
</ul>
<p>There are countless other features I hope to explore as well, but those are
some of the higher priority items as I view them.</p>
</li>
<li>
<p><strong>Stability</strong>: I would like to be able to declare a stable version within the
next year. I'm currently treating BonsaiDb as if it's stable: trying to
preserve backwards compatibility for the storage format, prioritizing bug
fixes, and keeping a thorough changelog.</p>
<p>By this time next year, I would like to be at a point where the core of
BonsaiDb is changing infrequently, and focus is on building higher level
abstractions.</p>
</li>
<li>
<p><strong>Tooling</strong>: A good, graphical database administration tool not only makes
exploring a database more approachable, it also can aide in quickly diagnosing
and fixing data issues. Because BonsaiDb is architected to not know about the
contents of the documents being stored, creating a good, generic
administration tool will be a fun challenge.</p>
</li>
<li>
<p><strong>Community</strong>: Fostering an active developer community around BonsaiDb is
important for many reasons. As I mentioned before, the more users BonsaiDb
has, the more confident we can all feel about its reliability. Beyond that,
however, is something more fundamental for me: I thrive on success stories and
helping solve interesting data problems.</p>
</li>
</ul>
<h2 id="-5">


<a href="#Help%20grow%20BonsaiDb" name="Help%20grow%20BonsaiDb">
    Help grow BonsaiDb
    <i class="bi bi-link-45deg hoverable"></i>
</a></h2>
<p>Building BonsaiDb has reawakened many of the passions I felt in my first
full-time computer-related job: working on REALbasic (now
<a href="https://www.xojo.com/">Xojo</a>). As I started getting schema design questions and
feature requests from potential users, I reflected on the joy those interactions
provided me. It is clear to me that one of the reasons I look back so fondly at
my first programming job is the wide array of problems I helped users solve.</p>
<p>For the longest time, I held off on allowing any means of sponsoring development
of BonsaiDb. Until recently, I was still hoping to get back to writing an MMO
once BonsaiDb was mature enough. My dreams have changed in the past months: I
want to focus on bringing safe, high-level data-oriented application development
to Rust. Initially, that means getting BonsaiDb to a maturity level where it
meets my original vision.</p>
<p>Many readers may not be aware that the early days of BonsaiDb development were
overlapped with my development of <a href="https://github.com/khonsulabs/gooey/">Gooey</a>. To this day, it is the only
framework that meets my personal desires of application development. However,
it's lacking many critical features/widgets. I paused development because I want
to focus on BonsaiDb. Yet, I also want to begin writing GUI administration tools
for BonsaiDb soon.</p>
<p>I would love to continue dedicating my focus to these areas of the Rust ecosystem:</p>
<ul>
<li>BonsaiDb: Easy-to-use database that grows with you.</li>
<li>Building cross-platform applications in Rust (with or without Gooey)</li>
</ul>
<p>If you would like to ensure my ability to continue working on these projects
full-time, I am now <a href="https://github.com/sponsors/ecton">accepting sponsorship through GitHub
Sponsors</a>. I have been working on open-source Rust projects since
November 2019 all funded by the sale of my previous startup. I would love the
opportunity to continue working on open-source full time without needing to
focus on building another startup. As I am not in dire need of finances, please
only sponsor me if you have truly disposable income.</p>
<p>Another important way to help grow BonsaiDb is to contribute. I've been working
on adding <a href="https://github.com/khonsulabs/bonsaidb/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22">&quot;Good First Issue&quot;</a> tasks. If you're looking to
contribute to an open-source Rust project, I would be honored to have you as
part of our team.</p>
<h2 id="-6">


<a href="#Trying%20out%20BonsaiDb" name="Trying%20out%20BonsaiDb">
    Trying out BonsaiDb
    <i class="bi bi-link-45deg hoverable"></i>
</a></h2>
<p>Our <a href="https://bonsaidb.io/">homepage</a> has basic setup instructions and a list of
examples. We have started writing a <a href="https://dev.bonsaidb.io/release/guide/">user's
guide</a>, and we have tried to write <a href="https://docs.rs/bonsaidb/">good
documentation</a>.</p>
<p>I would love to hear from you if you have questions or feedback. We have
<a href="https://community.khonsulabs.com/">community Discourse forums</a> and a <a href="https://discord.khonsulabs.com">Discord
server</a>, but also welcome anyone to <a href="https://github.com/khonsulabs/bonsaidb/issues/new">open an
issue</a> with any questions or
feedback.</p>
<p>Lastly, if you build something with one of our libraries, we would love to hear
about it. Nothing makes us happier than hearing people are building things with
our crates!</p>
<p>Thank you to all of the wonderful people in the Khonsu Labs community and the
Rust ecosystem.</p>

</div>


    <footer class="footer">
        <div class="content has-text-centered">
            <iframe src="https://github.com/sponsors/ecton/button" title="Sponsor ecton" height="35" width="116"
                style="border: 0;"></iframe>
            <p>
                <strong>BonsaiDb</strong> by <a href="https://khonsulabs.com">Khonsu Labs</a>. The <a
                    href="https://github.com/khonsulabs/bonsaidb">source code</a> is
                dual-licensed with
                <a href="https://github.com/khonsulabs/bonsaidb/blob/main/LICENSE-MIT">MIT</a> and <a
                    href="https://github.com/khonsulabs/bonsaidb/blob/main/LICENSE-APACHE">Apache License 2.0</a>. The
                website content
                is licensed <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY NC SA 4.0</a>.
            </p>
        </div>
    </footer>

    <script src="/site.js"></script>
</body>

</html>